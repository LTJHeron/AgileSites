<?xml version="1.0" ?>
<!DOCTYPE FTCS SYSTEM "futuretense_cs.dtd">
<FTCS Version="1.1">
<!-- 
$Logfile: /VerticalApps/XcelerateC/install/Gator/Populate/ElementCatalog/OpenMarket/Xcelerate/AssetType/AttrTypes/ContentForm.xml $ 
$Revision: 53 $ 
$Modtime: 4/30/04 4:47p $ 
-->
<!-- OpenMarket/Xcelerate/AssetType/AttrTypes/ContentForm
--
-	Form for creating/editing  AttrTypes
-- INPUT
--			ContentDetails: result of a scatter
-- OUTPUT
--
-- HISTORY 
   [2007-09-10 KG]
   * added XSS scripting fixes (adapted from 6.3 fixes); search for isCleanString
   * changed definitions of 'obj' to just forms[0] (not .elements[0])
   * added CDATA tags in first javascript block where appropriate.
   [2007-09-28 KG]
   * Removed a substitute operation (line 195 in previous revision).
     Now that csvar tags have been replaced with string.stream, it was doubling
     the effect of encoding the < character, and causing problems.
   [2007-10-09 KG]
   * XSS revision: minimized set of restricted characters.
-->
<!-- 
		setup all the fields in the AttrTypes  table
		as hidden input fields: this is required
		for replacerow to work. 
		
		Note: you must
		ensure that there is no more than one
		occurence of a form field that refers
		to one of these input fields. Else, browsers
		will concatenate all values found, surely
		leading to unexpected results

		Note: dates are dealt with a little differently

-->
 <CALLELEMENT NAME="OpenMarket/Xcelerate/Scripts/ValidateInputForXSS" />
<SCRIPT LANGUAGE="JavaScript">
<![CDATA[
function checkfields()
{
	var obj = document.forms[0];
	if (obj.elements['AttrTypes:name'].value=="")
	{
		alert("]]><XLAT.STREAM KEY="dvin/AT/AttrTypes/SpecUniqNameForAttrEdtr" ESCAPE="true" ENCODE="false"/><![CDATA[");
		obj.elements['AttrTypes:name'].focus();
		return false;
	}
	var isclean = isCleanString(obj.elements['AttrTypes:name'].value, '<">', true);	
	if (!isclean) {
		alert("]]><XLAT.STREAM KEY="dvin/FlexibleAssets/Attributes/ApostropheNotAllowedMinimal" ESCAPE="true" ENCODE="false"/><![CDATA[");
		obj.elements['AttrTypes:name'].focus();
		return false;
	}
	obj.submit();
	return false;
}

function SetCancelFlag () {
	var obj = document.forms[0];
	obj.elements['upcommand'].value="cancel";
	obj.submit();
	return false;
}
]]>
</SCRIPT>

<SCRIPT LANGUAGE="JavaScript">  
<![CDATA[
		
			function setCurrImage(obj) {
				obj.form.elements.currImage.value = obj.name;
			}
		
			function setCurrLinkset(obj) {
				obj.form.elements.currLinkset.value = obj.name;
			}
		
			function xfer(src,target,defpubid) {
				var sc, itemText, i, newIndex, listy;
  				
				for (i=0; i<src.options.length; i++) {
					if (src.options[i].selected) {
						var sc=i;
						var o=src.options[sc]
						items=new Option(o.text,o.value);
						newIndex=target.options.length;
						target.options[newIndex]=items;
 						target.options[newIndex].selected=true;
					}
				}
				i = 0;
				while (i<src.options.length) {
					if (src.options[i].selected)
						src.options[i]=null
					else
						i = i + 1;
				}
				delNul(src)
				delNul(target)
			}
		
			function delNul(lst){
				i = 0;
				while (i<lst.options.length) {
					if (lst.options[i].value==-1)
						lst.options[i]=null
					else
						i = i + 1;
				}
			}
		
			function selAll(lst){
		        if (!lst) return;
				for (i=0; i<lst.options.length; i++)
					lst.options[i].selected=true ;
 				delNul(lst);
			}

        
]]>
</SCRIPT>

<INPUT TYPE="hidden" NAME="upcommand" VALUE="submit"/>
<table border="0" cellpadding="0" cellspacing="0">

	<!-- page title w/ asset name -->
	<assettype.list LIST="ThisAsset" FIELD1="assettype" VALUE1="Variables.AssetType"/>
	<tr>
		<td><span class="title-text"><STRING.STREAM VALUE="ThisAsset.description"/>: </span><span class="title-value-text"><STRING.STREAM VARIABLE="ContentDetails:name"/></span></td>
	</tr>
	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/TitleBar">
		<argument NAME="SpaceBelow" VALUE="No"/>
	</callelement>
    
	<tr>
		<td align="left">
			<XLAT.LOOKUP KEY="dvin/AT/Common/CancelChanges" VARNAME="CancelChanges" ESCAPE="true"/>
            <XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="ALTCancel"/>
            <A HREF="javascript:void(0)" onclick="return SetCancelFlag()" onmouseover="window.status='Variables.CancelChanges';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.CancelChanges">
				<IMG  src="Variables.cs_imagedir/graphics/SessionVariables.locale/button/administration/images/cancel.gif" ALT="Variables.ALTCancel" BORDER="0" VSPACE="10" REPLACEALL="Variables.cs_imagedir,Variables.ALTCancel,SessionVariables.locale"/>
			</A>
			<img height="1" width="10" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
			<IF COND="Variables.updatetype=setformdefaults">
				<THEN>
            <XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="ForSave" ESCAPE="true"/>
            <XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="ALTSave"/>
            <A HREF="javascript:void(0)" onclick="return checkfields();" onmouseover="window.status='Variables.ForSave';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.ForSave">
 					<IMG  src="Variables.cs_imagedir/graphics/SessionVariables.locale/button/content/images/save.gif" ALT="Variables.ALTSave" VSPACE="10" BORDER="0" REPLACEALL="Variables.cs_imagedir,Variables.ALTSave,SessionVariables.locale"/>
				 </A>
        </THEN>
				<ELSE>
            <XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="SaveChanges" ESCAPE="true"/>
            <XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="ALTSave"/>
            <A HREF="javascript:void(0)" onclick="return checkfields();" onmouseover="window.status='Variables.SaveChanges';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.SaveChanges">
						<IMG  src="Variables.cs_imagedir/graphics/SessionVariables.locale/button/content/images/save_changes.gif" ALT="Variables.ALTSave" VSPACE="10" BORDER="0" REPLACEALL="Variables.cs_imagedir,Variables.ALTSave,SessionVariables.locale"/>
					</A>
        </ELSE>
			</IF>			
		</td>
	</tr>
    
     

	
	<!-- attribute inspection form -->
	<tr>
		<td><table border="0" cellpadding="0" cellspacing="0">
                        
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar">
				<argument NAME="SpaceAbove" VALUE="No"/>
			</callelement>

			<!--CheckforQuotes outputs :name and :description-->			
      <callelement NAME="OpenMarket/Gator/FlexibleAssets/Common/CheckforQuotes">
		    <argument NAME="Prefix" VALUE="AttrTypes"/>
			</callelement>
		
			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar"/>
			<tr>
				<td class="form-label-text"><XLAT.STREAM KEY="dvin/AT/AttrTypes/XMLinfile"/>:</td>
				<td></td>
				<td>
					<XLAT.LOOKUP KEY="dvin/AT/AttrTypes/BrowseforXML" VARNAME="_XLAT_" ESCAPE="true"/>
					<input TYPE="FILE" NAME="AttrTypes:urlxml" ONMOUSEOVER="window.status='Variables._XLAT_';return true;" ONMOUSEOUT="window.status='';return true" REPLACEALL="Variables._XLAT_"/>
				</td>
			</tr>

			<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacer"/>
			<tr>
				<td class="form-label-text" valign="top"><XLAT.STREAM KEY="dvin/AT/Common/XML"/>:</td>
				<td></td>
				<td>
					<textarea name="AttrTypeText" rows="24" cols="48" wrap="virtual"><STRING.STREAM VARIABLE="ContentDetails:urlxml"/></textarea>
				</td>
			</tr>

			<!-- named associations if there are any -->		 
	        <ASSOCNAMEDMANAGER.LIST  LISTVARNAME="associations" TYPE="Variables.AssetType"/>
            <IF COND="associations.#numRows!=0">
			<THEN>
				<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/RowSpacerBar"/>
				<tr>
					<td valign="top" class="form-label-text"><XLAT.STREAM KEY="dvin/Common/Related"/>:</td>
					<td></td>
					<td><table cellspacing="0" cellpadding="0" border="0"><tr><td><CALLELEMENT NAME="OpenMarket/Xcelerate/Actions/AssetMgt/AssetChildrenForm"/></td></tr></table></td>
				</tr>
			</THEN>
			</IF>
			
	</table> </td>
	</tr>
	
 	<callelement NAME="OpenMarket/Xcelerate/UIFramework/Util/FooterBar"/>

   <tr>
		<td align="left">
			<XLAT.LOOKUP KEY="dvin/AT/Common/CancelChanges" VARNAME="CancelChanges" ESCAPE="true"/>
            <XLAT.LOOKUP KEY="dvin/UI/Cancel" VARNAME="ALTCancelThis"/>
            <A HREF="javascript:void(0)" onclick="return SetCancelFlag()" onmouseover="window.status='Variables.CancelChanges';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.CancelChanges">
				<IMG  src="Variables.cs_imagedir/graphics/SessionVariables.locale/button/content/images/cancel.gif" ALT="Variables.ALTCancelThis" BORDER="0" VSPACE="10" REPLACEALL="Variables.cs_imagedir,Variables.ALTCancelThis,SessionVariables.locale,ThisAsset.description"/>
                </A>
			<img height="1" width="10" src="Variables.cs_imagedir/graphics/common/screen/dotclear.gif" REPLACEALL="Variables.cs_imagedir"/>
			<IF COND="Variables.updatetype=setformdefaults">
				<THEN>
            <XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="ForSave" ESCAPE="true"/>
            <XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="ALTSaveThis"/>
            <A HREF="javascript:void(0)" onclick="return checkfields();" onmouseover="window.status='Variables.ForSave';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.ForSave">
 					<IMG  src="Variables.cs_imagedir/graphics/SessionVariables.locale/button/content/images/save.gif" ALT="Variables.ALTSaveThis" VSPACE="10" BORDER="0" REPLACEALL="Variables.cs_imagedir,Variables.ALTSaveThis,SessionVariables.locale"/>
                    </A>
        </THEN>
				<ELSE>
            <XLAT.LOOKUP KEY="dvin/AT/Common/SaveChanges" VARNAME="SaveChanges" ESCAPE="true"/>
            <XLAT.LOOKUP KEY="dvin/UI/Save" VARNAME="ALTSaveThis"/>
            <A HREF="javascript:void(0)" onclick="return checkfields();" onmouseover="window.status='Variables.SaveChanges';return true;" onmouseout="window.status='';return true;" REPLACEALL="Variables.SaveChanges">
                    	<IMG  src="Variables.cs_imagedir/graphics/SessionVariables.locale/button/content/images/save_changes.gif" ALT="Variables.ALTSaveThis" VSPACE="10" BORDER="0" REPLACEALL="Variables.cs_imagedir,Variables.ALTSaveThis,SessionVariables.locale"/>
                    </A>
        </ELSE>
			</IF>			
		</td>
	</tr>
 
   </table>

</FTCS>
